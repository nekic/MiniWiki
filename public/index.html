<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MiniWiki</title>
    <link rel="stylesheet" href="/css/normalize.css">
    <!-- ZUI 标准版压缩后的 CSS 文件 -->
    <link rel="stylesheet" href="/plugins/zui/css/zui.min.css">
    <link rel="stylesheet" href="/plugins/zui/css/zui-theme.css">

    <!-- ZUI Javascript 依赖 jQuery -->
    <script src="/plugins/jquery/jquery-1.11.3.min.js"></script>
    <!-- ZUI 标准版压缩后的 JavaScript 文件 -->
    <script src="/plugins/zui/js/zui.min.js"></script>

    <!-- markdown 解释器 -->
    <script src="/plugins/marked/marked.min.js"></script>

    <!-- 编辑器 -->
    <script src="/plugins/codemirror/lib/codemirror.js"></script>
    <link rel="stylesheet" href="/plugins/codemirror/lib/codemirror.css">
    <script src="/plugins/codemirror/mode/markdown/markdown.js"></script>

    <!-- 右键菜单 -->
    <script src="/plugins/contextmenu/jquery.ui.position.min.js"></script>
    <script src="/plugins/contextmenu/jquery.contextMenu.min.js"></script>
    <link rel="stylesheet" href="/plugins/contextmenu/jquery.contextMenu.css">

    <!-- 弹出层 -->
    <script src="/plugins/vex/js/vex.combined.min.js"></script>
    <script>vex.defaultOptions.className = 'vex-theme-wireframe'</script>
    <link rel="stylesheet" href="/plugins/vex/css/vex.css">
    <link rel="stylesheet" href="/plugins/vex/css/vex-theme-wireframe.css">

</head>
<body>

<div class="container-fluid">
    <div class="row" style="height: 10px;"></div>
    <div class="row">
        <div class="col-md-3">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <span id="menu-tag" class="label label-dot label-success"></span>

                </div>
                <div class="panel-body">
                    <div id="menu-content" class="menu">
                        <ul id="menu-tree" class="tree tree-angles" data-ride="tree"
                            data-initial-state="preserve">

                        </ul>
                    </div>
                    <div id="toc-content" class="toc" style="display: none">这里是目录/滚动监听</div>
                </div>
            </div>
        </div>
        <div class="col-md-9">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <span>/ 首页 / PHP / 命名空间</span>
                    <span class="pull-right">
                        <i style="cursor: pointer;display: none;" id="save-tag" class="icon icon-save"></i>
                        <span>&nbsp;</span>
                        <i style="cursor: pointer;display: none;" id="html-tag" class="icon icon-html5"></i>
                        <span>&nbsp;</span>
                        <i style="cursor: pointer" id="mark-tag"  class="icon icon-code"></i>
                    </span>
                </div>
                <div class="panel-body">
                    <div id="html-content">这是html内容</div>
                    <div id="mark-content" style="display: none">
                        <textarea id="editor"></textarea>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<script>

    var myTreeData = <?= $trees?>;

    $('#menu-tree').tree({data: myTreeData});

    var editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
        mode: "markdown",
        value: "在此处输入内容..."
    });

    $('#html-tag').click(function () {
        $('#save-tag').hide();
        $(this).hide();
        $('#mark-tag').show();
        $('#mark-content').hide();
        $('#html-content').show();
    });

    $('#mark-tag').click(function () {
        $('#save-tag').show();
        $('#html-tag').show();
        $(this).hide();
        $('#mark-content').show();
        $('#html-content').hide();
    });

    $('#menu-tag').click(function () {

        $(this).hasClass('label-success') ? $(this).toggleClass('label-success') && $(this).toggleClass('label-danger') : $(this).toggleClass('label-danger') && $(this).toggleClass('label-success');

        $('#toc-content').toggle();
        $('#menu-content').toggle();
    });




    $(function() {
        $.contextMenu({
            selector: '.context-menu',
//            callback: function(key, options) {
//                var m = "clicked: " + key;
//                window.console && console.log(m) || alert(m);
//                console.log(options.$trigger.href());
//            },
            items: {
                "newRoot": {
                    name: "新建顶级分类",
                    icon: "edit",
                    callback: function(key, options) {
                        var m = "edit was clicked";
                        window.console && console.log(m) || alert(m);
                    }
                },
                "newCategory": {name: "新建子分类", icon: "cut"},
                "newNote": {
                    name: "新建笔记",
                    icon: "copy",
                    callback: function (key, options) {
                        var element = this;
                        vex.dialog.prompt({
                            message: '输入新建笔记名称',
                            placeholder: '新建笔记',
                            callback: function (value) {
                                addNote(value, element);
                            }
                        });
                    }
                },
                "rename": {name: "重命名", icon: "paste"},
                "delete": {name: "删除笔记", icon: "delete"},
                "move": {name: "移动", icon: "delete"},
                "sep1": "---------",
                "close": {name: "关闭", icon: function(){
                    return 'context-menu-icon context-menu-icon-quit';
                }}
            }
        });

        $('.context-menu-one').on('click', function(e){
            console.log('clicked', this);
        })
    });

    function addNote(value,element) {

    }

</script>
</body>

</html>